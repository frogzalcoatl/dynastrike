<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Dynastrike Demo</title>
	<style>
		body {
			display: flex;
			justify-content: center;
			align-items: center;
			width: 100vw;
			height: 100vh;
			margin: 0;
			background-color: #202020;
		}
	</style>
</head>

<body>
	<script src="../dist/dynastrike.global.js"></script>
	<script>
		const scene = new Dynastrike.Scene();
		for (let i = 0; i < 25; i++) {
			const entity = new Dynastrike.Entity(600 * Math.random(), 600 * Math.random(), 5);
			scene.addEntity(entity);
		}
		const playerEntity = new Dynastrike.Entity(300, 300, 10);
		scene.addEntity(playerEntity);
		let commands = 0;
		addEventListener("keydown", function (event) {
			switch (event.code) {
				case "KeyW": commands |= 1; break;
				case "KeyS": commands |= 2; break;
				case "KeyA": commands |= 4; break;
				case "KeyD": commands |= 8; break;
			}
		});
		addEventListener("keyup", function (event) {
			switch (event.code) {
				case "KeyW": commands &= ~1; break;
				case "KeyS": commands &= ~2; break;
				case "KeyA": commands &= ~4; break;
				case "KeyD": commands &= ~8; break;
			}
		});
		const canvasElement = document.createElement("canvas");
		canvasElement.width = 600;
		canvasElement.height = 600;
		document.body.appendChild(canvasElement);
		const ctx = canvasElement.getContext("2d", { alpha: false, willReadFrequently: false, desynchronized: true });
		ctx.imageSmoothingEnabled = false;
		function animationFrame() {
			scene.tick();
			if (commands & 1) playerEntity.velocity.y -= 0.1;
			if (commands & 2) playerEntity.velocity.y += 0.1;
			if (commands & 4) playerEntity.velocity.x -= 0.1;
			if (commands & 8) playerEntity.velocity.x += 0.1;
			ctx.clearRect(0, 0, canvasElement.width, canvasElement.height);
			ctx.fillStyle = "#FFFFFF";
			ctx.strokeStyle = "#FF0000";
			for (const entity of scene.entities.values()) {
				ctx.beginPath();
				ctx.arc(entity.position.x, entity.position.y, entity.radius, 0, Math.PI * 2);
				ctx.closePath();
				ctx.fill();
			}
			requestAnimationFrame(animationFrame);
		}
		requestAnimationFrame(animationFrame);
	</script>
</body>

</html>